(window.webpackJsonp=window.webpackJsonp||[]).push([[9,10,11,12],{466:function(e,t,l){"use strict";l.r(t);var r=l(40),n=l(81),o=(l(82),{props:["current"],data:function(){return{newItem:{},models:{cmp:{fields:["title"]},prj:{fields:["title"]},bld:{fields:["title"]},sct:{fields:["title"]},flr:{fields:["title"]},flt:{fields:["title"]}},targets:[{id:"pwa",label:"PWA"},{id:"vk",label:"VK"},{id:"instagram",label:"Instagram"}],fields:Object(n.a)({cmp:{type:"select",label:"Компания",placeholder:"Выберите компанию"},title:{type:"input",label:"Название",placeholder:"Введите название"},description:{type:"input",label:"Описание",placeholder:"Введите описание"},login:{type:"input",label:"Логин",placeholder:"Введите логин"},password:{type:"input",label:"Пароль",placeholder:"Введите пароль"}},"title",{type:"input",label:"Название",placeholder:"Введите название"})}},methods:{create:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,"bld"===e.current.modelForCreate&&(e.newItem.cmp=e.current.profile.cmp,e.newItem.prj=e.current.profile._id),console.log(e.newItem),t.next=5,e.$axios.$post("/api/"+e.current.modelForCreate+"/create",{params:JSON.stringify(e.newItem)});case 5:e.newItem={},e.$emit("success"),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.log(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()},getOptions:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function l(){return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,t.$axios.$get("/api/"+e+"/getAll");case 2:t.fields[e].options=l.sent;case 3:case"end":return l.stop()}}),l)})))()},go:function(e){"create"===e&&this.create(),"cancel"===e&&(this.newItem={}),this.$bvModal.hide("databaseModalCreate")}}}),c=l(203),component=Object(c.a)(o,(function(){var e=this,t=e._self._c;return t("b-modal",{attrs:{id:"databaseModalCreate","hide-footer":"","hide-header":"",centered:""}},[null!==e.current.modelForCreate?t("div",{staticClass:"d-flex flex-column w-100 h-100 overflowxy justify-content-center align-items-center"},[t("div",{staticClass:"d-flex flex-column justify-content-center p-4"},[e._l(e.models[e.current.modelForCreate].fields,(function(l){return t("div",{key:l,staticClass:"d-flex flex-column outline br-075 shadow-sm my-2 p-3 bg-white"},[t("span",{staticClass:"mb-2"},[e._v("\n                    "+e._s(e.fields[l].label)+"\n                ")]),e._v(" "),"input"===e.fields[l].type?t("b-form-input",{model:{value:e.newItem[l],callback:function(t){e.$set(e.newItem,l,t)},expression:"newItem[field]"}}):e._e(),e._v(" "),"select"===e.fields[l].type?t("b-form-select",{attrs:{options:e.fields[l].options,"value-field":"_id","text-field":"title"},nativeOn:{blur:function(t){return e.getOptions(l)}},model:{value:e.newItem[l],callback:function(t){e.$set(e.newItem,l,t)},expression:"newItem[field]"}}):e._e()],1)})),e._v(" "),t("Button",{staticClass:"d-flex flex-row justify-content-center py-3 bg-success text-white br-075 mt-5",attrs:{label:"Создать"},on:{click:function(t){return e.go("create")}}}),e._v(" "),t("Button",{staticClass:"d-flex flex-row justify-content-center py-3 text-white br-075",attrs:{label:"Отменить"},on:{click:function(t){return e.go("cancel")}}})],2)]):e._e()])}),[],!1,null,null,null);t.default=component.exports},467:function(e,t,l){"use strict";l.r(t);var r=l(40),n=(l(82),{props:["current","items"],data:function(){return{fieldForUpdate:{id:null,value:null},menu:[{id:"params",label:"Параметры",icon:{type:"fa",prefix:"fas",src:"xmark"}},{id:"bld",label:"Здания",icon:{type:"fa",prefix:"fas",src:"xmark"}}],menuActive:"params",fields:{title:{type:"input",label:"Название"},prefix:{type:"input",label:"Префикс"},login:{type:"input",label:"Login"}}}},methods:{goMenu:function(e){e.id;var t=e.item;this.menuActive=t},createStart:function(e){this.$emit("createStart",e)},getItems:function(e){var t=this;return Object(r.a)(regeneratorRuntime.mark((function l(){return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,t.$axios.$get("/api/"+e+"/getAll");case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}}),l)})))()},updateStart:function(e){this.fieldForUpdate={id:e,value:this.current.profile[e]},this.$bvModal.show("databaseModalUpdate")},updateSuccess:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var l,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,l={_id:e.current.profile._id,fields:[e.fieldForUpdate]},t.next=4,e.$axios.$put("/api/"+e.current.model.id+"/update",{params:JSON.stringify(l)});case 4:r=t.sent,console.log(r),e.$bvModal.hide("databaseModalUpdate"),e.fieldForUpdate={id:null,value:null},t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))()},updateCancel:function(){this.$bvModal.hide("databaseModalUpdate"),this.fieldForUpdate={id:null,value:null}}}}),o=l(203),component=Object(o.a)(n,(function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"fade-x",mode:"in-out",appear:""}},[t("div",{staticClass:"d-flex flex-column w-100 h-100 br-lt-125 outline shadow overflowxy bg-light p-3 pos-absolute zindex5"},[t("div",{staticClass:"d-flex flex-row justify-content-between align-items-center mb-3"},[t("div",{staticClass:"d-flex flex-row align-items-center"},[t("Button",{staticClass:"p-3 rounded-circle outline cursor-pointer",attrs:{icon:{type:"fa",prefix:"fas",src:"xmark"},iconClass:"d-flex"},on:{click:function(t){return e.$emit("close")}}}),e._v(" "),t("span",{staticClass:"h4 my-0 fw-600 ml-3"},[e._v("Проект")])],1),e._v(" "),t("Navmenu",{staticClass:"d-flex flex-row",attrs:{items:e.menu,active:e.menuActive,itemLabelKey:"label",itemClass:"d-flex flex-row align-items-center mr-2 br-075 cursor-pointer px-3 py-2 ws-nowrap",itemClassDefault:"bg-transparent hover-shadow",itemClassActive:"bg-white text-dark shadow",itemValueKey:"id",idKey:"menuProfile",itemIconKey:"icon",itemClassIcon:"mr-2"},on:{go:e.goMenu}})],1),e._v(" "),t("transition",{attrs:{name:"fade",mode:"out-in"}},["params"===e.menuActive?t("b-row",e._l(e.current.model.fieldsUpdate,(function(l){return t("b-col",{key:l,attrs:{xs:"12",sm:"6",md:"4"}},[t("div",{staticClass:"d-flex flex-column p-3 br-075 outline shadow-sm"},[t("div",{staticClass:"d-flex flex-row justify-content-between align-items-center mb-2"},[t("span",{staticClass:"fs-08"},[e._v(e._s(e.fields[l].label))]),e._v(" "),t("Button",{staticClass:"cursor-pointer fs-08 d-flex flex-row flex-row-reverse align-items-center text-info",attrs:{label:"Редактировать",icon:{type:"fa",prefix:"fas",src:"gear"},iconClass:"d-flex ml-2"},on:{click:function(t){return e.updateStart(l)}}})],1),e._v(" "),t("span",{staticClass:"h5 my-0 fw-600 ws-nowrap"},[e._v("\n                            "+e._s(e.current.profile[l])+"\n                        ")])])])})),1):e._e(),e._v(" "),"bld"===e.menuActive?t("b-row",[t("div",{staticClass:"d-flex flex-column"},[t("div",{staticClass:"d-flex flex-row px-3"},[t("Button",{staticClass:"px-3 py-2 bg-success text-white br-075",attrs:{label:"Добавить здание"},on:{click:function(t){return e.createStart("bld")}}})],1),e._v(" "),e._l(e.getItems("bld"),(function(l){return t("div",{key:l._id,staticClass:"d-flex flex-column"},[t("div",{staticClass:"d-flex flex-row"},[t("span",[e._v(e._s(l.title))])])])}))],2)]):e._e()],1),e._v(" "),t("b-modal",{attrs:{id:"databaseModalUpdate","hide-footer":"","hide-header":"",centered:""}},[t("div",{staticClass:"d-flex flex-column w-100 h-100 overflowxy justify-content-center align-items-center"},[null!==e.fieldForUpdate.id?t("div",{staticClass:"d-flex flex-column"},["input"===e.fields[e.fieldForUpdate.id].type?t("b-input",{model:{value:e.fieldForUpdate.value,callback:function(t){e.$set(e.fieldForUpdate,"value",t)},expression:"fieldForUpdate.value"}}):e._e(),e._v(" "),t("Button",{staticClass:"d-flex flex-row justify-content-center py-3 bg-success text-white br-075 mt-5",attrs:{label:"Сохранить"},on:{click:e.updateSuccess}}),e._v(" "),t("Button",{staticClass:"d-flex flex-row justify-content-center py-3 text-white br-075",attrs:{label:"Отменить"},on:{click:e.updateCancel}})],1):e._e()])])],1)])}),[],!1,null,null,null);t.default=component.exports},468:function(e,t,l){"use strict";l.r(t);var r={props:["current","items"]},n=l(203),component=Object(n.a)(r,(function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"fade",mode:"out-in",appear:""}},[t("div",{key:"table"+e.current.model.id+e.current.page,staticClass:"d-flex flex-column w-100 h-100 overflowxy bg-white"},[t("b-table",{attrs:{hover:"",items:e.items.result,fields:e.current.model.fieldsTable},scopedSlots:e._u([{key:"cell(_id)",fn:function(data){return[t("div",{staticClass:"d-flex flex-row"},[t("transition",{attrs:{name:"fade",mode:"out-in",appear:""}},[null!==e.current.profile&&e.current.profile._id===data.value?t("Button",{staticClass:"cursor-pointer mr-3 text-warning h5 my-0",attrs:{icon:{type:"fa",src:"pause",prefix:"fas"}},on:{click:function(t){return e.$emit("go",null)}}}):t("Button",{staticClass:"cursor-pointer mr-3 text-success h5 my-0",attrs:{icon:{type:"fa",src:"play",prefix:"fas"}},on:{click:function(t){return e.$emit("go",data.value)}}})],1),e._v("\n\n                    "+e._s(data.value)+"\n\n                ")],1)]}}])})],1)])}),[],!1,null,null,null);t.default=component.exports},821:function(e,t,l){"use strict";l.r(t);l(80),l(57);var r=l(40),n=(l(215),l(210),l(82),l(466)),o=l(467),c=l(468),d={props:[""],components:{ModalCreate:n.default,Table:c.default,Profile:o.default},data:function(){return{current:{model:null,modelForCreate:null,view:null,action:{id:null},profile:null,page:1,pageSize:12,total:0},items:{result:[],view:[{id:"card",label:"Карточки",icon:{type:"fa",src:"square",prefix:"fas"}},{id:"table",label:"Таблица",icon:{type:"fa",src:"bars",prefix:"fas"}}],model:[{id:"cmp",label:"Компании",icon:{type:"fa",src:"helmet-safety",prefix:"fas"},fieldsTable:["_id","title"],fieldsUpdate:["title"],tabs:["params"]},{id:"prj",label:"Проекты",icon:{type:"fa",src:"location-dot",prefix:"fas"},fieldsTable:["_id","title"],fieldsUpdate:["title"],tabs:["params","buildings"]},{id:"bld",label:"Здания",icon:{type:"fa",src:"location-dot",prefix:"fas"},fieldsTable:["_id","title"],fieldsUpdate:["title"],tabs:["params","buildings"]},{id:"sct",label:"Секции",icon:{type:"fa",src:"location-dot",prefix:"fas"},fieldsTable:["_id","title"],fieldsUpdate:["title"],tabs:["params","buildings"]},{id:"flr",label:"Типовые этажи",icon:{type:"fa",src:"location-dot",prefix:"fas"},fieldsTable:["_id","title"],fieldsUpdate:["title"],tabs:["params","buildings"]},{id:"flt",label:"Планировки",icon:{type:"fa",src:"location-dot",prefix:"fas"},fieldsTable:["_id","title"],fieldsUpdate:["title"],tabs:["params","buildings"]},{id:"prd",label:"Помещения",icon:{type:"fa",src:"key",prefix:"fas"},fieldsTable:["_id"],fieldsUpdate:["title"],tabs:["params"]},{id:"usr",label:"Пользователи",icon:{type:"fa",src:"location-dot",prefix:"fas"},fieldsTable:["_id","title"],fieldsUpdate:["title"],tabs:["params","buildings"]},{id:"med",label:"Медиа",icon:{type:"fa",src:"photo-film",prefix:"fas"},fieldsTable:["_id"],fieldsUpdate:["title"],tabs:["params"]}],action:[{id:"create",label:"Создать",icon:{type:"fa",src:"plus",prefix:"fas"}},{id:"import",label:"Импортировать",icon:{type:"fa",src:"file-import",prefix:"fas"}},{id:"export",label:"Экспортировать",icon:{type:"fa",src:"file-export",prefix:"fas"}}]}}},mounted:function(){this.current.model=this.items.model[0],this.current.view=this.items.view[1]},methods:{profileClose:function(){this.current.profile=null},getItems:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var l,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,l={skip:e.current.page*e.current.pageSize-e.current.pageSize,limit:e.current.pageSize},t.next=4,e.$axios.$get("/api/"+e.current.model.id+"/getByParams/"+JSON.stringify(l));case 4:void 0!==(r=t.sent)[0].counts[0]?(e.items.result=r[0].items,e.current.total=r[0].counts[0].total):(e.items.result=[],e.current.total=0),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))()},createStart:function(e){this.current.modelForCreate=e,this.$bvModal.show("databaseModalCreate")},goAction:function(e){e.id;var t=e.item;this.current.action=t,"create"===t&&this.createStart(this.current.model.id)},goView:function(e){e.id;var t=e.item;this.current.view=this.items.view.find((function(i){return i.id===t}))},goModel:function(e){e.id;var t=e.item;this.current.profile=null,this.current.model=this.items.model.find((function(i){return i.id===t}))},goProfile:function(e){this.current.profile=null===e?null:this.items.result.find((function(i){return i._id===e}))}},watch:{"current.model.id":{handler:function(e,t){["cmp","prj"].includes(this.current.model.id)&&(this.page=1,this.getItems())}}}},f=l(203),component=Object(f.a)(d,(function(){var e=this,t=e._self._c;return null!==e.current.model?t("div",{staticClass:"d-flex flex-column w-100 h-100 overflowxy bg-light pos-relative"},[t("div",{staticClass:"d-flex flex-row align-items-center justify-content-between p-3 shadow-sm"},[t("Navmenu",{staticClass:"d-flex flex-row",attrs:{items:e.items.action,active:e.current.action.id,itemLabelKey:"label",itemClass:"d-flex flex-row align-items-center mr-2 br-075 cursor-pointer h6 my-0 px-3 ws-nowrap font-weight-600 text-black",itemClassDefault:"bg-transparent hover-shadow",itemClassActive:"bg-white text-dark shadow",itemValueKey:"id",idKey:"menuModel",itemIconKey:"icon",itemClassIcon:"mr-3",itemStyle:"height:35px;"},on:{go:e.goAction}})],1),e._v(" "),t("div",{staticClass:"d-flex flex-column w-100 h-100"},["table"===e.current.view.id?t("Table",{staticClass:"w-100 h-100",attrs:{items:e.items,current:e.current},on:{go:e.goProfile,close:e.goProfile}}):e._e()],1),e._v(" "),t("div",{staticClass:"d-flex flex-row p-3 border-top"},[t("Navmenu",{staticClass:"d-flex flex-row",attrs:{items:e.items.view.filter((function(e){return"profile"!==e.id})),active:e.current.view.id,itemLabelKey:"label",itemClass:"d-flex flex-row align-items-center mr-2 br-075 cursor-pointer h6 px-3 ws-nowrap",itemClassDefault:"bg-transparent hover-shadow",itemClassActive:"bg-white text-dark shadow",itemValueKey:"id",idKey:"menuModel",itemIconKey:"icon",itemClassIcon:"mr-3",itemStyle:"height:35px;"},on:{go:e.goView}})],1),e._v(" "),null!==e.current.profile?t("Profile",{attrs:{items:e.items,current:e.current},on:{close:e.profileClose,createStart:e.createStart}}):e._e(),e._v(" "),t("ModalCreate",{attrs:{current:e.current},on:{success:e.getItems}})],1):e._e()}),[],!1,null,null,null);t.default=component.exports}}]);